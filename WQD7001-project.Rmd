---
# Branch maimul
title: "Parents’ Educational Background and Children’s Success"
author: "Maimul"
date: '2022-05-04'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(psych)
library("codebook")
```


### Load file to r as dataframe
```{r}
df1 <- read.csv('~/Documents/Principle of DS/Project/datasets/student-mat.csv') # Change this according to the file name and directory of the file.

```



### Explore the dataset
```{r}
dim(df1) # Check the dimension of the dataset

# glimpse is better than str(). More organised, easy to read. 
# Also dim f(x) is baked into the glimpse.
glimpse(df1) # from tidyverse

# Explore the column names
names(df1)

# Before checking for missing values, list all unique values in the dataframe. Look for "" cells
unique(unlist(df1))
```
There are no empty cells to impute. Example: "" to NA

```{r}
# Check for missing data in df1
print(colSums(is.na(df1)))
```
No NA values. 

```{r}
# Before we change the datatypes we must check the unique values in each column.
lapply(df1, unique) # lapply always returns a list. 
```


### Change the datatype of each column accordingly 
```{r}
# List columns that should be factor (not ordered)
col_factors <- c('school', 'sex', 'address','Pstatus','Mjob','Fjob','reason','guardian')
df1[col_factors] <- lapply(df1[col_factors], factor)

# List columns that should be factor (ordered)
col_factorsO <- c('famsize')
df1[col_factorsO] <- lapply(df1[col_factorsO], ordered, levels = c('LE3','GT3'))

col_factorsO <- c(names(df1[24:29]),'Medu','Fedu','traveltime','studytime','famsize')
df1[col_factorsO] <- lapply(df1[col_factorsO], ordered)

# List columns that should be binary
col_binary <- c('schoolsup','famsup','paid','activities','nursery','higher','internet','romantic')
df1[col_binary]  <- ifelse(df1[col_binary] == 'yes',1,0)
df1[col_binary]  <- lapply(df1[col_binary], as.logical)


```

```{r}
# 4. Check for missing data
sum(is.na(df1))


# 9 List rows with missing data
df1[!complete.cases(df1), ]

# 11. Identify duplicate row
sum(duplicated(df1))  

# 12. Observe invalid values
describe(df1)
```



# Descriptive Analysis
```{r}
summary(df1)
sum(is.na(df1))

# Display all the unordered factors in bar-plot
for (i in col_factors){
  barplot(table(df1[i]), main = i, col = c(7,10,13,14,19,23))
}

# Display all the ordered factors in bar-plot
for (i in col_factorsO){
  barplot(table(df1[i]), main = i,col = c(7,10,13,14,19,23))
}

# Display all the logical values in bar-plot
for (i in col_binary){
  barplot(table(df1[i]), main = i,col = c(7,10,13,14,19,23))
}

# Boxplot for all integer columns
for (i in c('absences','G1','G2','G3')){
  boxplot(df1[i], main = i,col = c(7,10,13,14,19,23))
}
```

```{r}
# Remove outliers from absences column
outliers_up <- 8 + 1.5 * IQR(df1$absences) # only upper outliers as 1st quartile is 0 and makes sense to have 0 absence


nrow(df1)
paste0("There are ",sum(df1$absences > outliers_up)," outliers out of ",nrow(df1),".")
paste0(round((15/395)*100,2),"% of the values in the absences column are outliers and since it is less than 10% of the dataset we can remove the outliers.")

```

