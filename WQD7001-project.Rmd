---
# Branch maimul
title: "Parents’ Educational Background and Children’s Success"
author: "Maimul"
date: '2022-05-04'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(psych)
library("codebook")
```


### Load file to r as dataframe
```{r}
df1 <- read.csv('~/Documents/Principle of DS/Project/datasets/student-mat.csv') # Change this according to the file name and directory of the file.

```



### Explore the dataset
```{r}
dim(df1) # Check the dimension of the dataset

# glimpse is better than str(). More organised, easy to read. 
# Also dim f(x) is baked into the glimpse.
glimpse(df1) # from tidyverse

# Explore the column names
names(df1)

# Before checking for missing values, list all unique values in the dataframe. Look for "" cells
unique(unlist(df1))
```
There are no empty cells to impute. Example: "" to NA

```{r}
# Check for missing data in df1
print(colSums(is.na(df1)))
```
No NA values. 

```{r}
# Before we change the datatypes we must check the unique values in each column.
lapply(df1, unique) # lapply always returns a list. 
```


### Change the datatype of each column accordingly 
```{r}
# List columns that should be factor (not ordered)
col_factors <- c('school', 'sex', 'address','Pstatus','Mjob','Fjob','reason','guardian')
df1[col_factors] <- lapply(df1[col_factors], factor)

# List columns that should be factor (ordered)
col_factorsO <- c('famsize')
df1[col_factorsO] <- lapply(df1[col_factorsO], ordered, levels = c('LE3','GT3'))

col_factorsO <- c(names(df1[24:29]),'Medu','Fedu','traveltime','studytime','famsize')
df1[col_factorsO] <- lapply(df1[col_factorsO], ordered)

# List columns that should be binary
col_binary <- c('schoolsup','famsup','paid','activities','nursery','higher','internet','romantic')
df1[col_binary]  <- ifelse(df1[col_binary] == 'yes',1,0)
df1[col_binary]  <- lapply(df1[col_binary], as.logical)


```

```{r}
# 4. Check for missing data
sum(is.na(df1))


# 9 List rows with missing data
df1[!complete.cases(df1), ]

# 11. Identify duplicate row
sum(duplicated(df1))  

# 12. Observe invalid values
describe(df1)
```



# Descriptive Analysis
```{r}
summary(df1)
sum(is.na(df1))

# Display all the unordered factors in bar-plot
for (i in col_factors){
  barplot(table(df1[i]), main = i, col = c(7,10,13,14,19,23))
}

# Display all the ordered factors in bar-plot
for (i in col_factorsO){
  barplot(table(df1[i]), main = i,col = c(7,10,13,14,19,23))
}

# Display all the logical values in bar-plot
for (i in col_binary){
  barplot(table(df1[i]), main = i,col = c(7,10,13,14,19,23))
}

# Boxplot for all integer columns
for (i in c('absences','G1','G2','G3')){
  boxplot(df1[i], main = i,col = c(7,10,13,14,19,23))
}
```

```{r}
# Remove outliers from absences column
outliers_up <- 8 + 1.5 * IQR(df1$absences) # only upper outliers as 1st quartile is 0 and makes sense to have 0 absence


nrow(df1)
paste0("There are ",sum(df1$absences > outliers_up)," outliers out of ",nrow(df1),".")
paste0(round((15/395)*100,2),"% of the values in the absences column are outliers and since it is less than 10% of the dataset we can remove the outliers.")

# Group by both fathers and mothers education
df1 %>% 
  select(Medu,Fedu,G3) %>% 
  group_by(Medu,Fedu) %>% 
  summarise(sum(G3))

# Group by mothers education
df1_Medu <- df1 %>% 
    select(Medu,G3) %>% 
    group_by(Medu) %>% 
    summarise(G3_sum = sum(G3))

# Scatter plot for mothers education vs grades
df1_Medu %>% 
  plot(G3_sum ~ Medu, main="Mother's education vs grades", 
   xlab="Mother's education level ", ylab="Grades of students")

# Group by fathers education
df1_Fedu <- df1 %>% 
    select(Fedu,G3) %>% 
    group_by(Fedu) %>% 
    summarise(G3_sum = sum(G3))

# Scatter plot for fathers education vs grades
df1_Fedu %>% 
  plot(G3_sum ~ Medu, main="Father's education vs grades", 
   xlab="Father's education level ", ylab="Grades of students")

# Group by mothers education and summarise failure
df1_Medu <- df1 %>% 
    select(Medu,failures) %>% 
    group_by(Medu) %>% 
    summarise(G3_sum = sum(failures))

# Scatter plot for mothers education vs failures
df1_Medu %>% 
  plot(G3_sum ~ Medu, main="Mother's education vs failures", 
   xlab="Mother's education level ", ylab="Failure of students")



# Group by fathers education and summarise failure
df1_Fedu <- df1 %>% 
    select(Fedu,failures) %>% 
    group_by(Fedu) %>% 
    summarise(G3_sum = sum(failures))

# Scatter plot for fathers education vs failures
df1_Fedu %>% 
  plot(G3_sum ~ Medu, main="Father's education vs failures", 
   xlab="Father's education level ", ylab="Failure of students")

# Ann
library(ggplot2)

# Histogram of age
hist(df1$age, main = "Distribution of student's age", xlab = "Student's age", ylab = "Number of student", col = "light blue")
# Histogram of absences
hist(df1$absences, main = "Distribution of student's absences", xlab = "Students absences", ylab = "Number of student", col = "light green")
# Histogram of average grade
average = (df1$G1 + df1$G2 + df1$G3)/3
average
hist(average, main = "Distribution of student's average grade", xlab = "Student's average grade", ylab = "Number of student", col = "yellow")
# bar graph of studytime & higher vs Medu
ggplot(df1, aes(x = Medu, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Mother's education level") +
  xlab("Mother's eduction level") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))
# bar graph of studytime & higher vs Fedu
ggplot(df1, aes(x = Fedu, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Father's education level") +
  xlab("Father's eduction level") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))
# bar graph of studytime & higher vs Mjob
ggplot(df1, aes(x = Mjob, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Mother's job") +
  xlab("Mother's job") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))
# bar graph of studytime & higher vs Fjob
ggplot(df1, aes(x = Fjob, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Father's job") +
  xlab("Father's job") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))
# bar graph of studytime & higher vs paid
ggplot(df1, aes(x = paid, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Extra paid classes") +
  xlab("Extra paid classes") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))
# bar graph of studytime & higher vs famrel
ggplot(df1, aes(x = famrel, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Quality of family relationships") +
  xlab("Quality of family relationships") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))
# bar graph of studytime & higher vs health
ggplot(df1, aes(x = health, y = studytime, fill = higher)) + 
  geom_bar(position = "dodge", stat = "identity") +  
  ggtitle("Student's study time & Pursuing Higher education VS Current health status") +
  xlab("Current health status") + 
  ylab("Student's study time") +  
  scale_fill_manual("Pursuing higher education", values = c("light blue", "light green"))

```

```{r}
# Aainaa
sex.freq <- table(df1$sex)
barplot(sex.freq, main = "Distribution of Student's Gender", xlab = "Student's Gender", ylab = "Number of Student", names.arg = c("Female", "Male"), col = "#FFEBCD")
```

```{r}
age.freq <- table(df1$age)
barplot(age.freq, main = "Distribution of Student's Age", xlab = "Student's Age", ylab = "Number of Student", col = "#D8BFD8")
```

```{r}
pstatus.freq <- table(df1$Pstatus)
barplot(pstatus.freq, main = "Distribution of Parent's Cohabitation Status", xlab = "Parent's Cohabitation Status", ylab = "Number of Student", names.arg = c("Living Apart", "Living Together"), col = "#D2691E")
```

```{r}
medu.freq <- table(df1$Medu)
barplot(medu.freq, main = "Distribution of Mother's Education", xlab = "Mother's Education", ylab = "Number of Student", names.arg = c("None", "4th Grade", "5-9th Grade", "Secondary Edu", "Higher Edu"), col = "#FFE4E1")
```

```{r}
fedu.freq <- table(df1$Fedu)
barplot(fedu.freq, main = "Distribution of Father's Education", xlab = "Father's Education", ylab = "Number of Student", names.arg = c("None", "4th Grade", "5-9th Grade", "Secondary Edu", "Higher Edu"), col = "light blue")
```

```{r}
mjob.freq <- table(df1$Mjob)
barplot(sort(mjob.freq, decreasing = FALSE), main = "Distribution of Mother's Occupation", xlab = "Mother's Occupation", ylab = "Number of Student", names.arg = c("Healthcare", "Teacher", "Housewife", "Civil Services", "Other"), col = "#FFC0CB")
```

```{r}
fjob.freq <- table(df1$Fjob)
barplot(sort(fjob.freq, decreasing = FALSE), main = "Distribution of Father's Occupation", xlab = "Father's Occupation", ylab = "Number of Student", names.arg = c("Healthcare", "Househusband", "Teacher", "Civil Services", "Other"), col = "#E0FFFF")
```

```{r}
studytime.freq <- table(df1$studytime)
barplot(studytime.freq, main = "Distribution of Weekly Study Time", xlab = "Study Time", ylab = "Number of Student", names.arg = c("< 2 hours", "2 to 5 hours", "5 to 10 hours", "> 10 hours"), col = "#F0E68C")
```

```{r}
# x axis labels are not clear
failures.freq <- table(df1$failures)
barplot(failures.freq, main = "Distribution of Pass Class Failures", xlab = "Pass Class Failures", ylab = "Number of Student", col = "#B0C4DE")
```

```{r}
paid.freq <- table(df1$paid)
barplot(paid.freq, main = "Distribution of Extra Paid Class (Math)", xlab = "Extra Paid Class", ylab = "Number of Student", names.arg = c("No", "Yes"), col = "#FFDAB9")
```

```{r}
higher.freq <- table(df1$higher)
barplot(higher.freq, main = "Distribution of Furthering Studies", xlab = "Higher Education", ylab = "Number of Student", names.arg = c("No", "Yes"), col = "#E9967A")
```

```{r}
internet.freq <- table(df1$internet)
barplot(internet.freq, main = "Distribution of Home Internet Access", xlab = "Internet Access at Home", ylab = "Number of Student", names.arg = c("No", "Yes"),col = "#66CDAA")
```

```{r}
romantic.freq <- table(df1$romantic)
barplot(romantic.freq, main = "Distribution of Romantic Relationship", xlab = "In Romantic Relationship", ylab = "Number of Student", names.arg = c("No", "Yes"), col = "#E6E6FA")
```

```{r}
famrel.freq <- table(df1$famrel)
barplot(famrel.freq, main = "Distribution of Student's Family Relationship", xlab = "Family Relationship", ylab = "Number of Student", names.arg = c("Very Bad", "Bad", "Average", "Good", "Excellent"), col = "#FFE4B5")
```

```{r}
health.freq <- table(df1$health)
barplot(health.freq, main = "Distribution of Student's Health Status", xlab = "Current Health Status", ylab = "Number of Student", names.arg = c("Very Bad", "Bad", "Average", "Good", "Very Good"), col = "#F0FFF0")
```

```{r}
boxplot(df1$absences, main = "Distribution of School Absences", xlab = "Students", ylab = "Number of School Absences", col = "#DDA0DD")
```

```{r}
boxplot(df1$G1, main = "Distribution of First Period Grade", xlab = "Math", ylab = "First Period Grade", col = "#AFEEEE")
```

```{r}
boxplot(df1$G2, main = "Distribution of Second Period Grade", xlab = "Math", ylab = "Second Period Grade", col = "#EEE8AA")
```

```{r}
boxplot(df1$G3, main = "Distribution of Final Period Grade", xlab = "Math", ylab = "Final Period Grade", col = "#F4A460")
```
