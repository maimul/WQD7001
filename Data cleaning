# 1. Import the mathdata
library(tidyverse)
library(psych)
mathdata<-read.csv("C:\\Users\\HP 05-11-2019\\Downloads\\student-mat.csv")
print(mathdata)
head(mathdata)
str(mathdata)
summary(mathdata)
describe(mathdata)

# 2. Check inconsistent data(character)
unique(mathdata$school)
unique(mathdata$sex)
unique(mathdata$address)
unique(mathdata$famsize)
unique(mathdata$Pstatus)
unique(mathdata$Mjob)
unique(mathdata$Fjob)
unique(mathdata$reason)
unique(mathdata$guardian)
unique(mathdata$schoolsup)
unique(mathdata$famsup)
unique(mathdata$paid)
unique(mathdata$activities)
unique(mathdata$nursery)
unique(mathdata$higher)
unique(mathdata$internet)
unique(mathdata$romantic)

# 3. Change data type
mathdata$school <- as.factor(mathdata$school)
mathdata$school <- as.numeric(mathdata$school)
mathdata$sex <- as.factor(mathdata$sex)
mathdata$sex <- as.numeric(mathdata$sex)
mathdata$address <- as.factor(mathdata$address)
mathdata$address <- as.numeric(mathdata$address)
mathdata$famsize <- as.factor(mathdata$famsize)
mathdata$famsize <- as.numeric(mathdata$famsize)
mathdata$Pstatus <- as.factor(mathdata$Pstatus)
mathdata$Pstatus <- as.numeric(mathdata$Pstatus)
mathdata$Mjob <- as.factor(mathdata$Mjob)
mathdata$Mjob <- as.numeric(mathdata$Mjob)
mathdata$Fjob <- as.factor(mathdata$Fjob)
mathdata$Fjob <- as.numeric(mathdata$Fjob)
mathdata$reason <- as.factor(mathdata$reason)
mathdata$reason <- as.numeric(mathdata$reason)
mathdata$guardian <- as.factor(mathdata$guardian)
mathdata$guardian <- as.numeric(mathdata$guardian)
mathdata$schoolsup <- as.factor(mathdata$schoolsup)
mathdata$schoolsup <- as.numeric(mathdata$schoolsup)
mathdata$famsup <- as.factor(mathdata$famsup)
mathdata$famsup <- as.numeric(mathdata$famsup)
mathdata$paid <- as.factor(mathdata$paid)
mathdata$paid <- as.numeric(mathdata$paid)
mathdata$activities <- as.factor(mathdata$activities)
mathdata$activities <- as.numeric(mathdata$activities)
mathdata$nursery <- as.factor(mathdata$nursery)
mathdata$nursery <- as.numeric(mathdata$nursery)
mathdata$higher <- as.factor(mathdata$higher)
mathdata$higher <- as.numeric(mathdata$higher)
mathdata$internet <- as.factor(mathdata$internet)
mathdata$internet <- as.numeric(mathdata$internet)
mathdata$romantic <- as.factor(mathdata$romantic)
mathdata$romantic <- as.numeric(mathdata$romantic)

# 4. Check for missing data
sum(is.na(mathdata))

# 5. If data is clean, randomly generate NA to the mathdata dataset
na.gen <- function(data, n){
  i <- 1
  while(i < n+1){
    index1 <- sample(1:nrow(data), 1)
    index2 <- sample(1:ncol(data), 1)
    data[index1, index2] <- NA
    i = i+1
  }
  return(data)
}

# 6. Generate 50 NAs to the mathdata randomly
mathdata <- na.gen(mathdata, 50)

# 7. Check again for missing data
sum(is.na(mathdata))

# 8. List number of missing data in column
colSums(is.na(mathdata))

# 9 List rows with missing data
missingdata <- mathdata[!complete.cases(mathdata), ]
sum(is.na(missingdata))

# 10. Median imputation for numerical data & Mode imputation for categorical data
mathdata.impute <- mathdata
for (i in which(sapply(mathdata.impute, is.numeric))){
  mathdata.impute[is.na(mathdata.impute[, i]), i] <- median(mathdata.impute[, i], na.rm = TRUE)
}
sum(is.na(mathdata.impute))

# 11. Ientify duplicate row
duplicated(mathdata.impute)
sum(duplicated(mathdata.impute))

# 12. Observe invalid values
describe(mathdata.impute)
